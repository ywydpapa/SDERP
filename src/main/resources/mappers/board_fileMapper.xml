<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="board_file">

 
 <insert id="board_file_insert" >
 	insert into `swc_board_file` (bf_Title, bf_Contents, userNo)
 	values (#{bf_Title}, #{bf_Contents} , #{userNo});
 </insert>
 
 <select id="board_file_list" resultType="kr.swcore.sderp.board_file.dto.Board_fileDTO">
 	select * from `swc_board_file` 
	join `swc_user` on swc_board_file.userNo = swc_user.userNo
 	WHERE `bf_delflag` = 'n'
 	order by swc_board_file.regDatetime desc;
 </select>
 
 <select id="board_file_detail" resultType="kr.swcore.sderp.board_file.dto.Board_fileDTO">
 	select * from `swc_board_file` 
	join `swc_user` on swc_board_file.userNo = swc_user.userNo
 	WHERE `bf_pk` = #{bf_pk};
 </select>
 
 <update id="board_file_delete">
	update  `swc_board_file`
	set 
	`bf_delflag` = 'y'
	where bf_pk=#{bf_pk};
 </update>
 
 <update id="board_file_update">
	update  `swc_board_file`
	set 
	 bf_Title=#{bf_Title},
	bf_Contents=#{bf_Contents}
	where bf_pk=#{bf_pk} 
 </update>
 <!-- 업로드 파일 --><!-- 업로드 파일 --><!-- 업로드 파일 --><!-- 업로드 파일 --><!-- 업로드 파일 -->
 <select id="listFile" resultType="board_fileDataDTO">
 	select *
 	from swc_noticefiledata
 	where bf_pk=#{bf_pk}
 	and attrib not like 'XXX%'
	order by uploadDate desc
</select>

<insert id="uploadFile">
	insert into swc_noticefiledata
	(
		fileId,
		fileName,
		fileDesc,
		uploadDate,
		fileContent,
		bf_pk,
		regDatetime,
		attrib
	)
 	values 
 	(
 		#{fileId},
 		#{fileName},
 		#{fileDesc},
 		now(),
 		#{fileContent},
 		#{bf_pk},
 	 	now(),
		10000
 	)
 </insert>
 <!-- 업로드 파일 --><!-- 업로드 파일 --><!-- 업로드 파일 --><!-- 업로드 파일 -->
 
 <select id="board_filedata_detail" resultType="kr.swcore.sderp.board_file.dto.Board_fileDataDTO">
 	select * from `swc_noticefiledata`
 	where `bf_pk` = #{bf_pk};
 </select>
 
 <select id="board_file_name" resultType="kr.swcore.sderp.board_file.dto.Board_fileDataDTO">
 	select `userName` from `swc_user`
 	where `userNo` = #{userNo};
 </select>
 
 
 <select id="downloadFile" resultType="board_fileDataDTO">
	select *
	from swc_noticefiledata  
	where fileId = #{fileId} and bf_pk= #{bf_pk}
</select>

<delete id="deleteFile">
	update swc_noticefiledata
	set attrib = 'XXXXX',
		modDatetime = now()
	where fileId = #{fileId} and bf_pk=#{bf_pk}
</delete>		
 
</mapper>